generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model business {
  id    Int     @id
  user  user    @relation(fields: [id], references: [id], map: "Business_id_fkey")
  event event[]
}

model event {
  id                  Int                   @id @default(autoincrement())
  name                String
  type                String
  category            String
  maximumCount        Int
  cordinatorName      String
  cordinatorContact   String
  description         String
  hashtag             String
  location            String
  country             String
  discount            Float?
  refundPolicy        String
  startTime           String
  endTime             String
  date                DateTime
  bannerUrl           String?
  businessId          Int
  business            business              @relation(fields: [businessId], references: [id], map: "Event_businessId_fkey")
  eventcondition      eventcondition[]
  eventspecification  eventspecification[]
  pricecategory       pricecategory[]
  touristeventbooking touristeventbooking[]

  @@index([businessId], map: "Event_businessId_fkey")
}

model eventcondition {
  id        Int    @id @default(autoincrement())
  condition String
  eventId   Int
  event     event  @relation(fields: [eventId], references: [id], map: "EventCondition_eventId_fkey")

  @@index([eventId], map: "EventCondition_eventId_fkey")
}

model eventspecification {
  id       Int    @id @default(autoincrement())
  specName String
  eventId  Int
  event    event  @relation(fields: [eventId], references: [id], map: "EventSpecification_eventId_fkey")

  @@index([eventId], map: "EventSpecification_eventId_fkey")
}

model pricecategory {
  id                  Int                   @id @default(autoincrement())
  name                String
  price               Float
  eventId             Int
  event               event                 @relation(fields: [eventId], references: [id], map: "PriceCategory_eventId_fkey")
  touristeventbooking touristeventbooking[]

  @@index([eventId], map: "PriceCategory_eventId_fkey")
}

model tourist {
  id                  Int                   @id
  email               String?               @db.VarChar(255)
  contactNo           String?               @db.VarChar(20)
  profilePic          String?               @db.VarChar(500)
  userId              Int?
  user                user                  @relation(fields: [id], references: [id], map: "Tourist_id_fkey")
  touristeventbooking touristeventbooking[]
}

model touristeventbooking {
  id              Int           @id @default(autoincrement())
  touristId       Int
  eventId         Int
  priceCategoryId Int
  paymentAmount   Float
  ticketCount     Int
  paymentDate     DateTime      @default(now())
  isRefunded      Boolean       @default(false)
  event           event         @relation(fields: [eventId], references: [id], map: "TouristEventBooking_eventId_fkey")
  pricecategory   pricecategory @relation(fields: [priceCategoryId], references: [id], map: "TouristEventBooking_priceCategoryId_fkey")
  tourist         tourist       @relation(fields: [touristId], references: [id], map: "TouristEventBooking_touristId_fkey")

  @@index([eventId], map: "TouristEventBooking_eventId_fkey")
  @@index([priceCategoryId], map: "TouristEventBooking_priceCategoryId_fkey")
  @@index([touristId], map: "TouristEventBooking_touristId_fkey")
}

model user {
  id        Int       @id @default(autoincrement())
  name      String
  email     String    @unique(map: "User_email_key")
  password  String
  createdAt DateTime  @default(now())
  role      user_role
  contactNo String?
  imageUrl  String?
  business  business?
  tourist   tourist?
}

enum user_role {
  TOURIST
  ADMIN
  BUSINESS
}
